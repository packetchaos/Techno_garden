import requests
import time
from Data_capture_container.database import new_db_connection


def request_data(method, url_mod):
    url = "http://0.0.0.0:5004/water/"

    try:
        r = requests.request(method, url + url_mod, verify=True)
        return r

    except Exception as E:
        print(E)


def time_loop():
    old_data = [[13,11234.0,"1588172380.35"],[13,12637.0,"1588172419.31"],[13,14130.0,"1588172460.82"],[13,15763.0,"1588172506.19"],[13,17016.0,"1588172540.9"],[13,18746.0,"1588172588.83"],[13,20232.0,"1588172630.08"],[13,21699.0,"1588172670.64"],[13,23303.0,"1588172715.05"],[13,25058.0,"1588172761.38"],[13,26477.0,"1588172797.89"],[13,28103.0,"1588172839.57"],[13,30016.0,"1588172888.65"],[13,32038.0,"1588172940.38"],[13,33688.0,"1588172982.73"],[13,35182.0,"1588173020.99"],[13,36575.0,"1588173056.61"],[13,37828.0,"1588173089.18"],[13,39046.0,"1588173121.54"],[13,40491.0,"1588173155.39"],[13,42012.0,"1588173190.98"],[13,43515.0,"1588173226.08"],[13,44848.0,"1588173257.17"],[13,46312.0,"1588173291.35"],[13,47896.0,"1588173328.35"],[13,49379.0,"1588173363.05"],[13,50873.0,"1588173398.41"],[13,52392.0,"1588173434.15"],[13,53741.0,"1588173467.16"],[13,54944.0,"1588173498.61"],[13,56396.0,"1588173536.46"],[13,57726.0,"1588173571.11"],[13,59096.0,"1588173606.8"],[13,60420.0,"1588173641.27"],[13,61801.0,"1588173677.2"],[13,63071.0,"1588173710.21"],[13,64400.0,"1588173744.77"],[13,65740.0,"1588173779.58"],[13,67144.0,"1588173815.69"],[13,68426.0,"1588173848.38"],[13,69719.0,"1588173881.38"],[13,71083.0,"1588173916.17"],[13,72412.0,"1588173950.0"],[13,73763.0,"1588173984.45"],[13,75061.0,"1588174017.5"],[13,76695.0,"1588174059.1"],[13,78009.0,"1588174092.56"],[13,79662.0,"1588174126.34"],[13,81507.0,"1588174157.55"],[13,83540.0,"1588174191.89"],[13,85539.0,"1588174225.5"],[13,87449.0,"1588174257.82"],[13,89573.0,"1588174293.79"],[13,91530.0,"1588174326.96"],[13,93517.0,"1588174360.7"],[13,95627.0,"1588174396.5"],[13,97589.0,"1588174429.72"],[13,99630.0,"1588174464.36"],[13,100050.0,"1588174497.36"],[13,100057.0,"1588255579.85"],[13,100369.0,"1588255614.94"],[13,100680.0,"1588258781.04"],[13,101846.0,"1588258815.05"],[13,103113.0,"1588258851.38"],[13,104201.0,"1588258882.47"],[13,105498.0,"1588258919.52"],[13,106718.0,"1588258954.29"],[13,107831.0,"1588258985.99"],[13,109080.0,"1588259021.56"],[13,110251.0,"1588259054.9"],[13,111436.0,"1588259088.6"],[13,112546.0,"1588259120.21"],[13,113789.0,"1588259154.03"],[13,115203.0,"1588259191.67"],[13,116409.0,"1588259223.73"],[13,117707.0,"1588259258.26"],[13,119114.0,"1588259295.42"],[13,120463.0,"1588259331.22"],[13,121630.0,"1588259362.11"],[13,122863.0,"1588259394.59"],[13,124182.0,"1588259429.38"],[13,125561.0,"1588259465.75"],[13,126921.0,"1588259501.71"],[13,128306.0,"1588259534.88"],[13,129844.0,"1588259571.79"],[13,131373.0,"1588259608.6"],[13,133075.0,"1588259649.51"],[13,134619.0,"1588259686.59"],[13,136048.0,"1588259720.92"],[13,137524.0,"1588259756.27"],[13,138927.0,"1588259790.02"],[13,140257.0,"1588259822.01"],[13,141603.0,"1588259854.54"],[13,142831.0,"1588259887.47"],[13,144027.0,"1588259919.57"],[13,145305.0,"1588259953.84"],[13,146542.0,"1588259986.86"],[13,147720.0,"1588260018.33"],[13,149067.0,"1588260054.32"],[13,150208.0,"1588260084.86"],[13,151335.0,"1588260114.98"],[13,152473.0,"1588260145.42"],[13,153614.0,"1588260175.83"],[13,154752.0,"1588260206.19"],[13,156036.0,"1588260239.16"],[13,157322.0,"1588260272.23"],[13,158671.0,"1588260306.76"],[13,160016.0,"1588260341.29"],[13,161330.0,"1588260375.01"],[13,162584.0,"1588260407.04"],[13,163904.0,"1588260440.89"],[13,165139.0,"1588260472.52"],[13,166367.0,"1588260503.97"],[13,168085.0,"1588260535.93"],[13,170082.0,"1588260570.52"],[13,171988.0,"1588260603.51"],[13,173754.0,"1588260634.04"],[13,175727.0,"1588260668.18"],[13,177748.0,"1588260703.08"],[13,179514.0,"1588260737.14"],[13,181290.0,"1588260770.81"],[13,183065.0,"1588260804.44"],[13,184811.0,"1588260837.5"],[13,186444.0,"1588260868.43"],[13,186635.0,"1588260901.05"]]

    for x in old_data:
        request_data("POST", str(x[0]) + "/" + str(x[1]) + "/" + str(x[2]))

        #time.sleep(5)


#time_loop()

def display():

    database = r"water_raw.db"
    water_conn = new_db_connection(database)
    water_conn.execute('pragma journal_mode=wal;')
    raw_list = []
    with water_conn:
        cur = water_conn.cursor()
        cur.execute("SELECT * FROM water;")

        rows = cur.fetchall()
        for x in rows:
            month = time.strftime("%B", time.localtime(float(x[2])))
            day = time.strftime("%d", time.localtime(float(x[2])))
            print(month + day)
            print(x)


display()
